{"pageProps":{"content":"\n              <a id=\"Oracle 配置 LogMiner\" style='display: block; height: 35px;'></a>\n              <h1>\n                Oracle 配置 LogMiner\n              </h1>\n            <p>注意：</p>\n<p>1、某个 Oracle 数据源能同时运行的任务数量取决于该 Oracle 的内存大小</p>\n<p>2、若数据量太大导致日志组频繁切换需要增加日志组数量，增大单个日志组存储大小</p>\n\n              <a id=\"一、Oracle 10g(单机版)\" style='display: block; height: 35px;'></a>\n              <h2>\n                一、Oracle 10g(单机版)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> *\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner1.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner2.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-comment\"># 创建归档日志保存目录</span>\n<span class=\"hljs-built_in\">mkdir</span> -p /data/oracle/archivelog\n\n<span class=\"hljs-comment\"># 进入Oracle目录</span>\n<span class=\"hljs-built_in\">cd</span> <span class=\"hljs-variable\">$ORACLE_HOME</span>\n\n<span class=\"hljs-comment\"># 查看Oracle权限组，本章权限组如下图所示</span>\n<span class=\"hljs-built_in\">ls</span> -l\n\n<span class=\"hljs-comment\"># 对归档日志保存目录赋予相应权限</span>\n<span class=\"hljs-built_in\">chown</span> -R 下图中的用户名:下图中的组名 /data/oracle/\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner3.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\">--配置归档日志保存的路径\nalter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。</p>\n<p><img src=\"/doc/LogMiner/LogMiner4.png\" alt=\"image\"></p>\n\n              <a id=\"4、配置日志组\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、配置日志组\n              </h3>\n            \n              <a id=\"a、查询默认日志组信息\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、查询默认日志组信息\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$<span class=\"hljs-built_in\">log</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner5.png\" alt=\"image\"></p>\n<p>如上图所示，日志组的默认数量为 2 组，大小为 4194304/1024/1024 = 4MB，这意味着日志大小每达到 4MB 就会进行日志组的切换，切换太过频繁会导致查询出错，因此需要增加日志组数量及大小。</p>\n\n              <a id=\"b、查询日志组储存路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、查询日志组储存路径\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\nFROM v$logfile<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner6.png\" alt=\"image\"></p>\n<p>如上图所示，默认路径为<code>/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/</code>。</p>\n\n              <a id=\"c、新增日志组与删除原有日志组\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、新增日志组与删除原有日志组\n              </h4>\n            <p>请与 DBA 联系，决定是否可以删除原有日志组。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-comment\">--增加两组日志组</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">3</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo3.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">4</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo4.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n</code></pre>\n<pre><code class=\"language-sql\"><span class=\"hljs-comment\">--删除原有两组日志组，并继续新增两组日志组</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">system</span> <span class=\"hljs-keyword\">checkpoint</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">system</span> switch logfile;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">drop</span>\nlogfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">1</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">drop</span>\nlogfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">2</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">1</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo1.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">2</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo2.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n</code></pre>\n\n              <a id=\"d、查询创建的日志组\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、查询创建的日志组\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$<span class=\"hljs-built_in\">log</span>;\n<span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$logfile;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner7.png\" alt=\"image\"></p>\n<p><img src=\"/doc/LogMiner/LogMiner8.png\" alt=\"image\"></p>\n\n              <a id=\"5、检查是否安装 LogMiner 工具\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、检查是否安装 LogMiner 工具\n              </h3>\n            <p>Oracle10g 默认已安装 LogMiner 工具包，通过以下命令查询：</p>\n<pre><code class=\"language-sql\">desc DBMS_LOGMNR<span class=\"hljs-comment\">;</span>\ndesc DBMS_LOGMNR_D<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p>若无信息打印，则执行下列 SQL 初始化 LogMiner 工具包：</p>\n<pre><code class=\"language-sql\">@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslm.sql;\n@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslmd.sql;\n</code></pre>\n\n              <a id=\"6、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"7、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                7、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"8、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                8、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner9.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner10.png\" alt=\"image\"></p>\n<p>至此，Oracle 10g 数据库 LogMiner 实时采集配置完毕。</p>\n\n              <a id=\"二、Oracle 11g(单机版)\" style='display: block; height: 35px;'></a>\n              <h2>\n                二、Oracle 11g(单机版)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> *\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner11.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner12.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-sql\"> alter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。\n<img src=\"/doc/LogMiner/LogMiner13.png\" alt=\"image\"></p>\n\n              <a id=\"4、检查是否安装 LogMiner 工具\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、检查是否安装 LogMiner 工具\n              </h3>\n            <p>Oracle11g 默认已安装 LogMiner 工具包，通过以下命令查询：</p>\n<pre><code class=\"language-sql\">desc DBMS_LOGMNR<span class=\"hljs-comment\">;</span>\ndesc DBMS_LOGMNR_D<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p>若无信息打印，则执行下列 SQL 初始化 LogMiner 工具包：</p>\n<pre><code class=\"language-sql\">@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslm.sql;\n@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslmd.sql;\n</code></pre>\n\n              <a id=\"5、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"6、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"7、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                7、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner14.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner15.png\" alt=\"image\"></p>\n<p>至此，Oracle 11g 数据库 LogMiner 实时采集配置完毕。</p>\n\n              <a id=\"三、Oracle 12c(单机版非 CBD)\" style='display: block; height: 35px;'></a>\n              <h2>\n                三、Oracle 12c(单机版非 CBD)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> BANNER\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner16.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner17.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-sql\"> alter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。\n<img src=\"/doc/LogMiner/LogMiner18.png\" alt=\"image\"></p>\n\n              <a id=\"4、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,logmining,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> LOGMINING <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"5、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"6、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner19.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner20.png\" alt=\"image\"></p>\n<p>至此，Oracle 12c 数据库 LogMiner 实时采集配置完毕。</p>\n","tree":[{"label":"General Configuration","category":"file"},{"label":"Quick Start","category":"file"},{"label":"Advanced Features","children":[{"label":"增量同步介绍","path":"增量同步介绍","category":"file"},{"label":"断点续传介绍","path":"断点续传介绍","category":"file"},{"label":"脏数据插件设计","path":"脏数据插件设计","category":"file"}],"category":"dir"},{"label":"ChunJun Connector","children":[{"label":"binlog","category":"dir","children":[{"label":"binlog-source","path":"binlog-source","category":"file"}]},{"label":"clickhouse","category":"dir","children":[{"label":"clickhouse-lookup","path":"clickhouse-lookup","category":"file"},{"label":"clickhouse-sink","path":"clickhouse-sink","category":"file"},{"label":"clickhouse-source","path":"clickhouse-source","category":"file"}]},{"label":"db2","category":"dir","children":[{"label":"db2-lookup","path":"db2-lookup","category":"file"},{"label":"db2-sink","path":"db2-sink","category":"file"},{"label":"db2-source","path":"db2-source","category":"file"}]},{"label":"dm","category":"dir","children":[{"label":"dm-sink","path":"dm-sink","category":"file"},{"label":"dm-source","path":"dm-source","category":"file"}]},{"label":"doris","category":"dir","children":[{"label":"dorisbatch-sink","path":"dorisbatch-sink","category":"file"}]},{"label":"elasticsearch","category":"dir","children":[{"label":"es7-lookup","path":"es7-lookup","category":"file"},{"label":"es7-sink","path":"es7-sink","category":"file"},{"label":"es7-source","path":"es7-source","category":"file"}]},{"label":"gbase","category":"dir","children":[{"label":"gbase-lookup","path":"gbase-lookup","category":"file"},{"label":"gbase-sink","path":"gbase-sink","category":"file"},{"label":"gbase-source","path":"gbase-source","category":"file"}]},{"label":"greenplum","category":"dir","children":[{"label":"greenplum-sink","path":"greenplum-sink","category":"file"},{"label":"greenplum-source","path":"greenplum-source","category":"file"}]},{"label":"hbase","category":"dir","children":[{"label":"hbase-lookup","path":"hbase-lookup","category":"file"},{"label":"hbase-sink","path":"hbase-sink","category":"file"},{"label":"hbase-source","path":"hbase-source","category":"file"}]},{"label":"hdfs","category":"dir","children":[{"label":"hdfs-sink","path":"hdfs-sink","category":"file"},{"label":"hdfs-source","path":"hdfs-source","category":"file"}]},{"label":"hive","category":"dir","children":[{"label":"hive-lookup","path":"hive-lookup","category":"file"},{"label":"hive-sink","path":"hive-sink","category":"file"}]},{"label":"influxdb","category":"dir","children":[{"label":"influxdb-sink","path":"influxdb-sink","category":"file"},{"label":"influxdb-source","path":"influxdb-source","category":"file"}]},{"label":"kafka","category":"dir","children":[{"label":"kafka-sink","path":"kafka-sink","category":"file"},{"label":"kafka-source","path":"kafka-source","category":"file"}]},{"label":"kingbase","category":"dir","children":[{"label":"kingbase-sink","path":"kingbase-sink","category":"file"},{"label":"kingbase-source","path":"kingbase-source","category":"file"}]},{"label":"kudu","category":"dir","children":[{"label":"kudu-lookup","path":"kudu-lookup","category":"file"},{"label":"kudu-sink","path":"kudu-sink","category":"file"},{"label":"kudu-source","path":"kudu-source","category":"file"}]},{"label":"logminer","category":"dir","children":[{"label":"LogMiner-source","path":"LogMiner-source","category":"file"},{"label":"LogMiner原理","path":"LogMiner原理","category":"file"},{"label":"LogMiner配置","path":"LogMiner配置","category":"file"}]},{"label":"mongodb","category":"dir","children":[{"label":"mongodb-lookup","path":"mongodb-lookup","category":"file"},{"label":"mongodb-sink","path":"mongodb-sink","category":"file"},{"label":"mongodb-source","path":"mongodb-source","category":"file"}]},{"label":"mysql","category":"dir","children":[{"label":"mysql-lookup","path":"mysql-lookup","category":"file"},{"label":"mysql-sink","path":"mysql-sink","category":"file"},{"label":"mysql-source","path":"mysql-source","category":"file"}]},{"label":"oracle","category":"dir","children":[{"label":"oracle-lookup","path":"oracle-lookup","category":"file"},{"label":"oracle-sink","path":"oracle-sink","category":"file"},{"label":"oracle-source","path":"oracle-source","category":"file"}]},{"label":"pgwal","category":"dir","children":[{"label":"Postgres-CDC","path":"Postgres-CDC","category":"file"}]},{"label":"postgresql","category":"dir","children":[{"label":"postgres-lookup","path":"postgres-lookup","category":"file"},{"label":"postgres-sink","path":"postgres-sink","category":"file"},{"label":"postgres-source","path":"postgres-source","category":"file"}]},{"label":"rocketmq","category":"dir","children":[{"label":"rocketmq-source","path":"rocketmq-source","category":"file"}]},{"label":"saphana","category":"dir","children":[{"label":"saphana-sink","path":"saphana-sink","category":"file"},{"label":"saphana-source","path":"saphana-source","category":"file"}]},{"label":"sqlserver","category":"dir","children":[{"label":"sqlserver-lookup","path":"sqlserver-lookup","category":"file"},{"label":"sqlserver-sink","path":"sqlserver-sink","category":"file"},{"label":"sqlserver-source","path":"sqlserver-source","category":"file"}]},{"label":"sqlservercdc","category":"dir","children":[{"label":"SqlServer CDC实时采集原理","path":"SqlServer CDC实时采集原理","category":"file"},{"label":"SqlServer配置CDC","path":"SqlServer配置CDC","category":"file"},{"label":"SqlserverCDC-source","path":"SqlserverCDC-source","category":"file"}]}],"category":"dir"},{"label":"ChunJun Extend Data Format","children":[{"label":"protobuf-x","path":"protobuf-x","category":"file"}],"category":"dir"},{"label":"Contribution","children":[{"label":"How to define a plugin","path":"How to define a plugin","category":"file"},{"label":"How to submit a great Pull Request","path":"How to submit a great Pull Request","category":"file"}],"category":"dir"}],"toc":[{"text":"Oracle 配置 LogMiner","level":1,"id":"803987ea-d7c1-487d-b4ef-0ee2cc0fc5b3"},{"text":"一、Oracle 10g(单机版)","level":2,"id":"16484166-c527-4f04-acb4-f83583e89f6b"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>","level":3,"id":"8ffbc9f1-b589-439a-a8ed-7c168e504ec8"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"aa0f0cab-e5a6-4140-9a4a-7600ce4cc5fc"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"6c4126bd-91f1-4d1c-8298-f226bcacd93a"},{"text":"a、配置归档日志保存的路径","level":4,"id":"2972e5c1-6939-4f92-a712-b397d327779d"},{"text":"b、关闭数据库","level":4,"id":"9a40388d-9679-46fb-8d30-50747265f2c0"},{"text":"c、开启日志归档","level":4,"id":"e1890745-968f-4273-ac43-d3f64f6bcc43"},{"text":"d、开启扩充日志","level":4,"id":"8564fb10-e882-4e9b-bdaf-a253f130ea3d"},{"text":"e、开启数据库","level":4,"id":"2dba5652-7876-4dc9-9e96-cb6ad67162fc"},{"text":"4、配置日志组","level":3,"id":"95ae4207-7511-4de9-a7f8-ca5ad16d6778"},{"text":"a、查询默认日志组信息","level":4,"id":"f947fd64-32c7-4489-92cf-da09cd9fa900"},{"text":"b、查询日志组储存路径","level":4,"id":"906a7cca-a6e7-40ad-b4da-e2f38e89dd5a"},{"text":"c、新增日志组与删除原有日志组","level":4,"id":"213c229d-ed4f-412e-b493-8768884638f5"},{"text":"d、查询创建的日志组","level":4,"id":"998a4d6c-ef0a-4e0f-9891-078ab09044c0"},{"text":"5、检查是否安装 LogMiner 工具","level":3,"id":"d38547f6-51bd-46dd-bf4d-d5003e4c1b6a"},{"text":"6、创建 LogMiner 角色并赋权","level":3,"id":"98945642-7442-4b34-9dbd-380214fd2c54"},{"text":"7、创建 LogMiner 用户并赋权","level":3,"id":"8b9bc01a-3647-44bb-a6b5-359c43b5e115"},{"text":"8、验证用户权限","level":3,"id":"23dd592f-c647-4013-90b7-b2e153a5e015"},{"text":"二、Oracle 11g(单机版)","level":2,"id":"765f444c-467b-4ef5-a84d-c59973a77d81"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>","level":3,"id":"ec45cb64-323d-489f-ab0c-7fa03c2114b5"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"b11f85fe-cfa2-4d44-b84c-644028c153d1"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"9e439059-af3f-4073-9314-83a070c85b72"},{"text":"a、配置归档日志保存的路径","level":4,"id":"3ee229c8-c56c-44e2-87c6-aeb286ca3c34"},{"text":"b、关闭数据库","level":4,"id":"d8a88413-b1cd-4575-859d-f914bf137ae9"},{"text":"c、开启日志归档","level":4,"id":"9d08995f-47a6-4411-82cf-f91a63544d87"},{"text":"d、开启扩充日志","level":4,"id":"e7655606-0a67-4762-86c4-66e36900ac9e"},{"text":"e、开启数据库","level":4,"id":"b40427dd-2c4b-463d-ac77-cfbcb9c9eb82"},{"text":"4、检查是否安装 LogMiner 工具","level":3,"id":"a04fdeea-85bd-4991-8b9d-141a92637da2"},{"text":"5、创建 LogMiner 角色并赋权","level":3,"id":"a35ecf40-087a-4c49-8275-4895f2dacda1"},{"text":"6、创建 LogMiner 用户并赋权","level":3,"id":"a4dc529a-38f7-4305-8251-16cdb4658055"},{"text":"7、验证用户权限","level":3,"id":"612f2c3b-a64c-44e6-8132-c805273a19ce"},{"text":"三、Oracle 12c(单机版非 CBD)","level":2,"id":"75bcd0da-a56f-4a8f-a500-61b42c0badab"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>","level":3,"id":"cda80ab7-521e-44f6-8467-be2ffa8274d3"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"23663317-695b-450c-b0f7-214db6b0220a"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"2b1fcc51-dd89-4611-b574-0db955ea5c6c"},{"text":"a、配置归档日志保存的路径","level":4,"id":"0cf332c9-0443-4c97-9fd4-715d8ce38b36"},{"text":"b、关闭数据库","level":4,"id":"0a3fe053-44a3-48aa-8ec6-2f2efa86a078"},{"text":"c、开启日志归档","level":4,"id":"1002379a-c08d-467d-96aa-6b61058d6b66"},{"text":"d、开启扩充日志","level":4,"id":"5395b954-9d5c-45f2-872a-74a864573a6f"},{"text":"e、开启数据库","level":4,"id":"727d9d08-4f5e-4925-b95c-144a54711d07"},{"text":"4、创建 LogMiner 角色并赋权","level":3,"id":"429a7b9a-7183-4fc8-86a9-14d8e2fd4942"},{"text":"5、创建 LogMiner 用户并赋权","level":3,"id":"10003526-a5f0-40b2-b1fc-05822b309e71"},{"text":"6、验证用户权限","level":3,"id":"21fc13cc-df2a-481c-9cca-e631b8966876"}]},"__N_SSG":true}
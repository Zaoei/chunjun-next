{"pageProps":{"content":"\n              <a id=\"Oracle 配置 LogMiner\" style='display: block; height: 35px;'></a>\n              <h1>\n                Oracle 配置 LogMiner\n              </h1>\n            <p>注意：</p>\n<p>1、某个 Oracle 数据源能同时运行的任务数量取决于该 Oracle 的内存大小</p>\n<p>2、若数据量太大导致日志组频繁切换需要增加日志组数量，增大单个日志组存储大小</p>\n\n              <a id=\"一、Oracle 10g(单机版)\" style='display: block; height: 35px;'></a>\n              <h2>\n                一、Oracle 10g(单机版)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> *\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner1.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner2.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-comment\"># 创建归档日志保存目录</span>\n<span class=\"hljs-built_in\">mkdir</span> -p /data/oracle/archivelog\n\n<span class=\"hljs-comment\"># 进入Oracle目录</span>\n<span class=\"hljs-built_in\">cd</span> <span class=\"hljs-variable\">$ORACLE_HOME</span>\n\n<span class=\"hljs-comment\"># 查看Oracle权限组，本章权限组如下图所示</span>\n<span class=\"hljs-built_in\">ls</span> -l\n\n<span class=\"hljs-comment\"># 对归档日志保存目录赋予相应权限</span>\n<span class=\"hljs-built_in\">chown</span> -R 下图中的用户名:下图中的组名 /data/oracle/\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner3.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\">--配置归档日志保存的路径\nalter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。</p>\n<p><img src=\"/doc/LogMiner/LogMiner4.png\" alt=\"image\"></p>\n\n              <a id=\"4、配置日志组\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、配置日志组\n              </h3>\n            \n              <a id=\"a、查询默认日志组信息\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、查询默认日志组信息\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$<span class=\"hljs-built_in\">log</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner5.png\" alt=\"image\"></p>\n<p>如上图所示，日志组的默认数量为 2 组，大小为 4194304/1024/1024 = 4MB，这意味着日志大小每达到 4MB 就会进行日志组的切换，切换太过频繁会导致查询出错，因此需要增加日志组数量及大小。</p>\n\n              <a id=\"b、查询日志组储存路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、查询日志组储存路径\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\nFROM v$logfile<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner6.png\" alt=\"image\"></p>\n<p>如上图所示，默认路径为<code>/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/</code>。</p>\n\n              <a id=\"c、新增日志组与删除原有日志组\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、新增日志组与删除原有日志组\n              </h4>\n            <p>请与 DBA 联系，决定是否可以删除原有日志组。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-comment\">--增加两组日志组</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">3</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo3.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">4</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo4.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n</code></pre>\n<pre><code class=\"language-sql\"><span class=\"hljs-comment\">--删除原有两组日志组，并继续新增两组日志组</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">system</span> <span class=\"hljs-keyword\">checkpoint</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">system</span> switch logfile;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">drop</span>\nlogfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">1</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">drop</span>\nlogfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">2</span>;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">1</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo1.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> logfile <span class=\"hljs-keyword\">group</span> <span class=\"hljs-number\">2</span> (<span class=\"hljs-string\">&#x27;/usr/lib/oracle/xe/app/oracle/flash_recovery_area/XE/onlinelog/redo2.log&#x27;</span>) size <span class=\"hljs-number\">200</span>m;\n</code></pre>\n\n              <a id=\"d、查询创建的日志组\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、查询创建的日志组\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$<span class=\"hljs-built_in\">log</span>;\n<span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> v$logfile;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner7.png\" alt=\"image\"></p>\n<p><img src=\"/doc/LogMiner/LogMiner8.png\" alt=\"image\"></p>\n\n              <a id=\"5、检查是否安装 LogMiner 工具\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、检查是否安装 LogMiner 工具\n              </h3>\n            <p>Oracle10g 默认已安装 LogMiner 工具包，通过以下命令查询：</p>\n<pre><code class=\"language-sql\">desc DBMS_LOGMNR<span class=\"hljs-comment\">;</span>\ndesc DBMS_LOGMNR_D<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p>若无信息打印，则执行下列 SQL 初始化 LogMiner 工具包：</p>\n<pre><code class=\"language-sql\">@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslm.sql;\n@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslmd.sql;\n</code></pre>\n\n              <a id=\"6、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"7、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                7、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"8、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                8、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner9.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner10.png\" alt=\"image\"></p>\n<p>至此，Oracle 10g 数据库 LogMiner 实时采集配置完毕。</p>\n\n              <a id=\"二、Oracle 11g(单机版)\" style='display: block; height: 35px;'></a>\n              <h2>\n                二、Oracle 11g(单机版)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> *\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner11.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner12.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-sql\"> alter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。\n<img src=\"/doc/LogMiner/LogMiner13.png\" alt=\"image\"></p>\n\n              <a id=\"4、检查是否安装 LogMiner 工具\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、检查是否安装 LogMiner 工具\n              </h3>\n            <p>Oracle11g 默认已安装 LogMiner 工具包，通过以下命令查询：</p>\n<pre><code class=\"language-sql\">desc DBMS_LOGMNR<span class=\"hljs-comment\">;</span>\ndesc DBMS_LOGMNR_D<span class=\"hljs-comment\">;</span>\n</code></pre>\n<p>若无信息打印，则执行下列 SQL 初始化 LogMiner 工具包：</p>\n<pre><code class=\"language-sql\">@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslm.sql;\n@\n<span class=\"hljs-variable\">$ORACLE_HOME</span>\n<span class=\"hljs-regexp\">/rdbms/</span>admin/dbmslmd.sql;\n</code></pre>\n\n              <a id=\"5、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"6、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"7、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                7、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner14.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner15.png\" alt=\"image\"></p>\n<p>至此，Oracle 11g 数据库 LogMiner 实时采集配置完毕。</p>\n\n              <a id=\"三、Oracle 12c(单机版非 CBD)\" style='display: block; height: 35px;'></a>\n              <h2>\n                三、Oracle 12c(单机版非 CBD)\n              </h2>\n            \n              <a id=\"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>\" style='display: block; height: 35px;'></a>\n              <h3>\n                1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查看oracle版本</span>\n<span class=\"hljs-keyword\">select</span> BANNER\n<span class=\"hljs-keyword\">from</span> v$<span class=\"hljs-keyword\">version</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner16.png\" alt=\"image\"></p>\n<p>本章 Oracle 的版本如上图所示。</p>\n\n              <a id=\"2、通过命令行方式登录 Oracle，查看是否开启日志归档\" style='display: block; height: 35px;'></a>\n              <h3>\n                2、通过命令行方式登录 Oracle，查看是否开启日志归档\n              </h3>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--查询数据库归档模式</span>\narchive\n<span class=\"hljs-built_in\">log</span> <span class=\"hljs-built_in\">list</span>;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner17.png\" alt=\"image\"></p>\n<p>图中显示<code>No Archive Mode</code>表示未开启日志归档。</p>\n\n              <a id=\"3、开启日志归档，开启日志归档需要重启数据库，请注意\" style='display: block; height: 35px;'></a>\n              <h3>\n                3、开启日志归档，开启日志归档需要重启数据库，请注意\n              </h3>\n            \n              <a id=\"a、配置归档日志保存的路径\" style='display: block; height: 35px;'></a>\n              <h4>\n                a、配置归档日志保存的路径\n              </h4>\n            <p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<pre><code class=\"language-sql\"> alter<span class=\"hljs-built_in\">\nsystem </span><span class=\"hljs-built_in\">set</span> <span class=\"hljs-attribute\">log_archive_dest_1</span>=<span class=\"hljs-string\">&#x27;location=/data/oracle/archivelog&#x27;</span> <span class=\"hljs-attribute\">scope</span>=spfile;\n</code></pre>\n\n              <a id=\"b、关闭数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                b、关闭数据库\n              </h4>\n            <pre><code class=\"language-sql\">shutdown\nimmediate<span class=\"hljs-comment\">;</span>\nstartup\nmount<span class=\"hljs-comment\">;</span>\n</code></pre>\n\n              <a id=\"c、开启日志归档\" style='display: block; height: 35px;'></a>\n              <h4>\n                c、开启日志归档\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启日志归档</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> archivelog;\n</code></pre>\n\n              <a id=\"d、开启扩充日志\" style='display: block; height: 35px;'></a>\n              <h4>\n                d、开启扩充日志\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-comment\">--开启扩充日志</span>\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">add</span> supplemental <span class=\"hljs-keyword\">log</span> data (<span class=\"hljs-keyword\">all</span>) <span class=\"hljs-keyword\">columns</span>;\n</code></pre>\n\n              <a id=\"e、开启数据库\" style='display: block; height: 35px;'></a>\n              <h4>\n                e、开启数据库\n              </h4>\n            <pre><code class=\"language-sql\"><span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">database</span> <span class=\"hljs-keyword\">open</span>;\n</code></pre>\n<p>再次查询数据库归档模式，<code>Archive Mode</code>表示已开启归档模式，<code>Archive destination</code>表示归档日志储存路径。\n<img src=\"/doc/LogMiner/LogMiner18.png\" alt=\"image\"></p>\n\n              <a id=\"4、创建 LogMiner 角色并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                4、创建 LogMiner 角色并赋权\n              </h3>\n            <p>其中<code>roma_logminer_privs</code>为角色名称，可根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">role</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span>\n<span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">session</span>,execute_catalog_role,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">transaction</span>,flashback <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,<span class=\"hljs-keyword\">lock</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">table</span>,logmining,<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">any</span> <span class=\"hljs-keyword\">dictionary</span> <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_COL$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_OBJ$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_USER$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">on</span> <span class=\"hljs-keyword\">SYSTEM</span>.LOGMNR_UID$ <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> select_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n<span class=\"hljs-keyword\">grant</span> LOGMINING <span class=\"hljs-keyword\">to</span> roma_logminer_privs;\n</code></pre>\n\n              <a id=\"5、创建 LogMiner 用户并赋权\" style='display: block; height: 35px;'></a>\n              <h3>\n                5、创建 LogMiner 用户并赋权\n              </h3>\n            <p>其中<code>roma_logminer</code>为用户名，<code>password</code>为密码，请根据自身需求修改。</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">create</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-keyword\">password</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">tablespace</span> users;\n<span class=\"hljs-keyword\">grant</span> roma_logminer_privs <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">grant</span> execute_catalog_role <span class=\"hljs-keyword\">to</span> roma_logminer;\n<span class=\"hljs-keyword\">alter</span>\n<span class=\"hljs-keyword\">user</span> roma_logminer quota unlimited <span class=\"hljs-keyword\">on</span> users;\n</code></pre>\n\n              <a id=\"6、验证用户权限\" style='display: block; height: 35px;'></a>\n              <h3>\n                6、验证用户权限\n              </h3>\n            <p>以创建的 LogMiner 用户登录 Oracle 数据库，执行以下 SQL 查询权限，结果如图所示：</p>\n<pre><code class=\"language-sql\"> <span class=\"hljs-keyword\">SELECT</span> *\n <span class=\"hljs-keyword\">FROM</span> USER_ROLE_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner19.png\" alt=\"image\"></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> *\n<span class=\"hljs-keyword\">FROM</span> SESSION_PRIVS;\n</code></pre>\n<p><img src=\"/doc/LogMiner/LogMiner20.png\" alt=\"image\"></p>\n<p>至此，Oracle 12c 数据库 LogMiner 实时采集配置完毕。</p>\n","tree":[{"label":"ChunJun通用配置详解","category":"file"},{"label":"快速开始","category":"file"},{"label":"ChunJun拓展数据格式","children":[{"label":"protobuf-x","path":"protobuf-x","category":"file"}],"category":"dir"},{"label":"ChunJun连接器","children":[{"label":"binlog","category":"dir","children":[{"label":"binlog-source","path":"binlog-source","category":"file"}]},{"label":"clickhouse","category":"dir","children":[{"label":"clickhouse-lookup","path":"clickhouse-lookup","category":"file"},{"label":"clickhouse-sink","path":"clickhouse-sink","category":"file"},{"label":"clickhouse-source","path":"clickhouse-source","category":"file"}]},{"label":"db2","category":"dir","children":[{"label":"db2-lookup","path":"db2-lookup","category":"file"},{"label":"db2-sink","path":"db2-sink","category":"file"},{"label":"db2-source","path":"db2-source","category":"file"}]},{"label":"dm","category":"dir","children":[{"label":"dm-sink","path":"dm-sink","category":"file"},{"label":"dm-source","path":"dm-source","category":"file"}]},{"label":"doris","category":"dir","children":[{"label":"dorisbatch-sink","path":"dorisbatch-sink","category":"file"}]},{"label":"elasticsearch","category":"dir","children":[{"label":"es7-lookup","path":"es7-lookup","category":"file"},{"label":"es7-sink","path":"es7-sink","category":"file"},{"label":"es7-source","path":"es7-source","category":"file"}]},{"label":"gbase","category":"dir","children":[{"label":"gbase-lookup","path":"gbase-lookup","category":"file"},{"label":"gbase-sink","path":"gbase-sink","category":"file"},{"label":"gbase-source","path":"gbase-source","category":"file"}]},{"label":"greenplum","category":"dir","children":[{"label":"greenplum-sink","path":"greenplum-sink","category":"file"},{"label":"greenplum-source","path":"greenplum-source","category":"file"}]},{"label":"hbase","category":"dir","children":[{"label":"hbase-lookup","path":"hbase-lookup","category":"file"},{"label":"hbase-sink","path":"hbase-sink","category":"file"},{"label":"hbase-source","path":"hbase-source","category":"file"}]},{"label":"hdfs","category":"dir","children":[{"label":"hdfs-sink","path":"hdfs-sink","category":"file"},{"label":"hdfs-source","path":"hdfs-source","category":"file"}]},{"label":"hive","category":"dir","children":[{"label":"hive-lookup","path":"hive-lookup","category":"file"},{"label":"hive-sink","path":"hive-sink","category":"file"}]},{"label":"influxdb","category":"dir","children":[{"label":"influxdb-sink","path":"influxdb-sink","category":"file"},{"label":"influxdb-source","path":"influxdb-source","category":"file"}]},{"label":"kafka","category":"dir","children":[{"label":"kafka-sink","path":"kafka-sink","category":"file"},{"label":"kafka-source","path":"kafka-source","category":"file"}]},{"label":"kingbase","category":"dir","children":[{"label":"kingbase-sink","path":"kingbase-sink","category":"file"},{"label":"kingbase-source","path":"kingbase-source","category":"file"}]},{"label":"kudu","category":"dir","children":[{"label":"kudu-lookup","path":"kudu-lookup","category":"file"},{"label":"kudu-sink","path":"kudu-sink","category":"file"},{"label":"kudu-source","path":"kudu-source","category":"file"}]},{"label":"logminer","category":"dir","children":[{"label":"LogMiner-source","path":"LogMiner-source","category":"file"},{"label":"LogMiner原理","path":"LogMiner原理","category":"file"},{"label":"LogMiner配置","path":"LogMiner配置","category":"file"}]},{"label":"mongodb","category":"dir","children":[{"label":"mongodb-lookup","path":"mongodb-lookup","category":"file"},{"label":"mongodb-sink","path":"mongodb-sink","category":"file"},{"label":"mongodb-source","path":"mongodb-source","category":"file"}]},{"label":"mysql","category":"dir","children":[{"label":"mysql-lookup","path":"mysql-lookup","category":"file"},{"label":"mysql-sink","path":"mysql-sink","category":"file"},{"label":"mysql-source","path":"mysql-source","category":"file"}]},{"label":"oracle","category":"dir","children":[{"label":"oracle-lookup","path":"oracle-lookup","category":"file"},{"label":"oracle-sink","path":"oracle-sink","category":"file"},{"label":"oracle-source","path":"oracle-source","category":"file"}]},{"label":"pgwal","category":"dir","children":[{"label":"Postgres-CDC","path":"Postgres-CDC","category":"file"}]},{"label":"postgresql","category":"dir","children":[{"label":"postgres-lookup","path":"postgres-lookup","category":"file"},{"label":"postgres-sink","path":"postgres-sink","category":"file"},{"label":"postgres-source","path":"postgres-source","category":"file"}]},{"label":"rocketmq","category":"dir","children":[{"label":"rocketmq-source","path":"rocketmq-source","category":"file"}]},{"label":"saphana","category":"dir","children":[{"label":"saphana-sink","path":"saphana-sink","category":"file"},{"label":"saphana-source","path":"saphana-source","category":"file"}]},{"label":"sqlserver","category":"dir","children":[{"label":"sqlserver-lookup","path":"sqlserver-lookup","category":"file"},{"label":"sqlserver-sink","path":"sqlserver-sink","category":"file"},{"label":"sqlserver-source","path":"sqlserver-source","category":"file"}]},{"label":"sqlservercdc","category":"dir","children":[{"label":"SqlServer CDC实时采集原理","path":"SqlServer CDC实时采集原理","category":"file"},{"label":"SqlServer配置CDC","path":"SqlServer配置CDC","category":"file"},{"label":"SqlserverCDC-source","path":"SqlserverCDC-source","category":"file"}]}],"category":"dir"},{"label":"开发者指南","children":[{"label":"如何提交一个优秀的PR","path":"如何提交一个优秀的PR","category":"file"},{"label":"如何自定义插件","path":"如何自定义插件","category":"file"}],"category":"dir"},{"label":"拓展功能","children":[{"label":"增量同步介绍","path":"增量同步介绍","category":"file"},{"label":"断点续传介绍","path":"断点续传介绍","category":"file"},{"label":"脏数据插件设计","path":"脏数据插件设计","category":"file"}],"category":"dir"}],"toc":[{"text":"Oracle 配置 LogMiner","level":1,"id":"0708cee2-1cbd-448d-af4f-d8ef95ade6f9"},{"text":"一、Oracle 10g(单机版)","level":2,"id":"646bc60f-cc17-4d5f-85de-281c759d8023"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 10g</code>","level":3,"id":"2ff810b0-42a1-457f-8b8e-3ee66dae041d"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"4968a636-714d-4916-8b59-688caa5cf7d0"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"b17ff65d-6254-478e-98cf-336cda078cbd"},{"text":"a、配置归档日志保存的路径","level":4,"id":"2ef716e0-b505-4f5f-851f-ba14042e3d05"},{"text":"b、关闭数据库","level":4,"id":"1b802643-5940-4f70-85b3-34a336ba2a33"},{"text":"c、开启日志归档","level":4,"id":"d69e7bc5-b80e-4154-afd7-6c1ba5fdb458"},{"text":"d、开启扩充日志","level":4,"id":"ae688981-e7f6-4764-9fba-cb2416bbd9a6"},{"text":"e、开启数据库","level":4,"id":"4571f9ec-538f-4f13-a460-d55abfa68223"},{"text":"4、配置日志组","level":3,"id":"1b7a5a88-4f5e-48e1-aebd-49e85d7ea7e6"},{"text":"a、查询默认日志组信息","level":4,"id":"8f3f7588-f826-4ddb-b103-6de36bb7abf3"},{"text":"b、查询日志组储存路径","level":4,"id":"94ded081-7c1b-4a90-90a3-f2465af4b2ac"},{"text":"c、新增日志组与删除原有日志组","level":4,"id":"33f98457-4814-41d8-89f7-6823fc7ab72d"},{"text":"d、查询创建的日志组","level":4,"id":"06d818f2-0697-4634-9e96-05bdaf74d4b6"},{"text":"5、检查是否安装 LogMiner 工具","level":3,"id":"48941327-3574-4ae2-babc-ccb2e4747500"},{"text":"6、创建 LogMiner 角色并赋权","level":3,"id":"6efc76af-28e1-4aef-a602-43223a815fcb"},{"text":"7、创建 LogMiner 用户并赋权","level":3,"id":"7bff99c1-e217-47c3-bf8a-e08a1126082c"},{"text":"8、验证用户权限","level":3,"id":"607bc904-d8fd-48b3-bf78-daa52d7e9334"},{"text":"二、Oracle 11g(单机版)","level":2,"id":"1df897b3-018c-4d98-bcc4-6b015c5a0df0"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 11g</code>","level":3,"id":"6c9fefad-909d-480a-ae6c-9439e8f46b09"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"e0b7d75f-19a1-4a06-b054-f1d62dc66378"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"46ca25c5-63ce-43f5-91ce-db9e681ae512"},{"text":"a、配置归档日志保存的路径","level":4,"id":"1a1d7d50-21b6-41d6-8f62-35101df93255"},{"text":"b、关闭数据库","level":4,"id":"0875d339-165e-4331-846e-dc545c60cbb2"},{"text":"c、开启日志归档","level":4,"id":"617bcd27-8398-4da6-b42d-d026236cd143"},{"text":"d、开启扩充日志","level":4,"id":"eb4215a6-33cd-44b9-8054-463926d5c2c7"},{"text":"e、开启数据库","level":4,"id":"ab8eda9d-1ca9-48fe-930e-8387f25b55a9"},{"text":"4、检查是否安装 LogMiner 工具","level":3,"id":"73bf2a73-3ffe-4c29-9a46-1a98e5eff4b3"},{"text":"5、创建 LogMiner 角色并赋权","level":3,"id":"24cedf85-f5cf-4a14-a85f-d962207d6c6c"},{"text":"6、创建 LogMiner 用户并赋权","level":3,"id":"1aacbf7f-d8e7-465f-8447-73c6394ca112"},{"text":"7、验证用户权限","level":3,"id":"bf8872eb-8217-48f0-b851-52f08d78cdd6"},{"text":"三、Oracle 12c(单机版非 CBD)","level":2,"id":"f7d2ce96-cc83-4ad3-bb58-bb8d22372dfa"},{"text":"1、查询 Oracle 版本信息，这里配置的是<code>Oracle 12c</code>","level":3,"id":"628b67b8-2410-420f-9297-b450c71391da"},{"text":"2、通过命令行方式登录 Oracle，查看是否开启日志归档","level":3,"id":"e4596f19-7604-4181-b341-7ac2b74f1a6c"},{"text":"3、开启日志归档，开启日志归档需要重启数据库，请注意","level":3,"id":"7f817205-4a19-4640-a491-295f97426aaa"},{"text":"a、配置归档日志保存的路径","level":4,"id":"49f0c8a2-9544-4fa5-8ec0-d9df46179bb6"},{"text":"b、关闭数据库","level":4,"id":"c407082c-3375-4b1b-868c-dd6744ba6a5d"},{"text":"c、开启日志归档","level":4,"id":"05f5efae-43b3-4c3d-b4fc-ce1fb5154850"},{"text":"d、开启扩充日志","level":4,"id":"78b70ea4-2eaf-4aa1-a4b4-1f5d1c4107a9"},{"text":"e、开启数据库","level":4,"id":"12e1e5e8-c6ba-4b68-9218-5cce8e9ed130"},{"text":"4、创建 LogMiner 角色并赋权","level":3,"id":"3297d28f-368e-446e-97c5-0a10dcadefa2"},{"text":"5、创建 LogMiner 用户并赋权","level":3,"id":"3f605e38-123b-47b3-bdb9-5f6804a9c02c"},{"text":"6、验证用户权限","level":3,"id":"5cab4725-41f8-4255-85ff-a08ff56cb8ed"}]},"__N_SSG":true}